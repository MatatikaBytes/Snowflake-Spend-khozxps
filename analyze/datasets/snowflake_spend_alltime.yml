version: datasets/v0.2
source: analyze/channels/snowflake
title: Snowflake spend (All time)
questions: What is the total Snowflake spend by month?
description: |-
  Snowflake spend for all warehouses.
  
  #snowflake #spend
metadata: |-
  {
    "name": "snowflake_spend",
    "label": "Snowflake Spend", 
    "related_table": {
      "columns": [
        {"name": "usage_month", "label": "Month", "description": "Month"}
      ],
      "aggregates": [
        {"name": "spend", "label": "Cost", "description": "Cost"}
      ]
    }
  }
visualisation: |-
  {"chartjs-chart": 
    {"chartType": "line", 
      "options": {
        "scales": {
          "x": {
            "stacked": true        
          },
          "y": {
            "beginAtZero": true,
            "stacked": true
          }
        }
      }
    }
  }
query: |-
  SELECT
    usage_month as "snowflake_spend.usage_month",
    sum(dollars_spent) AS "snowflake_spend.spend"
  FROM snowflake_warehouse_metering_xf
  GROUP BY usage_month
  ORDER BY usage_month;

